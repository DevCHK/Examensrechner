<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notenrechner Stex (Sachsen-Anhalt)</title>
  <style>
    :root {
      --bg-color: #f0f0f0;
      --text-color: #000;
      --accent-color: #2a7f62;
      --input-bg: #fff;
    }

    [data-theme="dark"] {
      --bg-color: #121212;
      --text-color: #f0f0f0;
      --accent-color: #68c3a3;
      --input-bg: #1e1e1e;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen;
      padding: 1em;
      background-color: var(--bg-color);
      color: var(--text-color);
      max-width: 600px;
      margin: auto;
      transition: background-color 0.3s, color 0.3s;
    }

    h1 {
      text-align: center;
    }

    label {
      display: block;
      margin-top: 1em;
    }

    input {
      width: 100%;
      padding: 0.5em;
      font-size: 1em;
      background-color: var(--input-bg);
      color: var(--text-color);
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      margin-top: 1em;
      width: 100%;
      padding: 1em;
      font-size: 1em;
      background-color: var(--accent-color);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .result {
      margin-top: 2em;
      font-size: 1.2em;
      font-weight: bold;
      text-align: center;
    }

    .formel {
      margin-top: 1em;
      font-size: 0.95em;
      background-color: var(--input-bg);
      padding: 1em;
      border-radius: 5px;
      white-space: pre-wrap;
    }

    .notenskala {
      margin-top: 2em;
      font-size: 0.9em;
    }

    .dark-toggle-container {
      text-align: right;
      margin-bottom: 1em;
    }

    .dark-toggle-container button {
      width: auto;
      padding: 0.5em 1em;
      font-size: 0.8em;
    }
  </style>
</head>
<body>
  <div class="dark-toggle-container">
    <button onclick="toggleDarkMode()">ðŸŒ“</button>
  </div>
  <h1>Notenrechner Sachsen-Anhalt</h1>

  <form id="notenForm">
    <label>Strafrecht I:
      <input type="number" step="0.01" name="straf1" />
    </label>
    <label>Strafrecht II:
      <input type="number" step="0.01" name="straf2" />
    </label>
    <label>Zivilrecht I:
      <input type="number" step="0.01" name="zivil1" />
    </label>
    <label>Zivilrecht II:
      <input type="number" step="0.01" name="zivil2" />
    </label>
    <label>Ã–ffentliches Recht I:
      <input type="number" step="0.01" name="oeff1" />
    </label>
    <label>Ã–ffentliches Recht II:
      <input type="number" step="0.01" name="oeff2" />
    </label>
    <label>MÃ¼ndliche PrÃ¼fung:
      <input type="number" step="0.01" name="muendlich" />
    </label>
    <label>Schwerpunktbereich:
      <input type="number" step="0.01" name="schwerpunkt" />
    </label>
    <button type="submit">Berechnen</button>
    <button type="button" onclick="resetForm()">ZurÃ¼cksetzen</button>
  </form>

  <div class="result" id="ergebnis"></div>
  <div class="formel" id="formel"></div>

  <div class="notenskala">
    <h3>Notenskala</h3>
    <ul>
      <li>Sehr gut: 14.00 - 18.00</li>
      <li>Gut: 11.50 - 13.99</li>
      <li>Vollbefriedigend (VB): 9.00 - 11.49</li>
      <li>Befriedigend: 6.50 - 8.99</li>
      <li>Ausreichend: 4.00 - 6.49</li>
      <li>Mangelhaft: 1.50 - 3.99</li>
      <li>UngenÃ¼gend: 0.00 - 1.49</li>
    </ul>
  </div>

  <script>
    function berechneNote(e) {
      e.preventDefault();
      const f = document.forms["notenForm"];
      const parse = (v) => parseFloat(v) || 0;

      const straf1 = parse(f.straf1.value);
      const straf2 = parse(f.straf2.value);
      const zivil1 = parse(f.zivil1.value);
      const zivil2 = parse(f.zivil2.value);
      const oeff1 = parse(f.oeff1.value);
      const oeff2 = parse(f.oeff2.value);
      const muendlich = parse(f.muendlich.value);
      const schwerpunkt = parse(f.schwerpunkt.value);

      const staatsteil = (straf1 + straf2 + zivil1 + zivil2 + oeff1 + oeff2) * 0.1 + muendlich * 0.4;
      const gesamt = staatsteil * 0.7 + schwerpunkt * 0.3;

      const stufe = (n) => {
        if (n >= 14) return "Sehr gut";
        if (n >= 11.5) return "Gut";
        if (n >= 9) return "Vollbefriedigend (VB)";
        if (n >= 6.5) return "Befriedigend";
        if (n >= 4) return "Ausreichend";
        if (n >= 1.5) return "Mangelhaft";
        return "UngenÃ¼gend";
      };

      const zurNaechstenStufe = (n) => {
        if (n < 1.5) return (1.5 - n).toFixed(2) + " Punkte bis 'Mangelhaft'";
        if (n < 4) return (4 - n).toFixed(2) + " Punkte bis 'Ausreichend'";
        if (n < 6.5) return (6.5 - n).toFixed(2) + " Punkte bis 'Befriedigend'";
        if (n < 9) return (9 - n).toFixed(2) + " Punkte bis 'Vollbefriedigend'";
        if (n < 11.5) return (11.5 - n).toFixed(2) + " Punkte bis 'Gut'";
        if (n < 14) return (14 - n).toFixed(2) + " Punkte bis 'Sehr gut'";
        return "Maximalnote erreicht";
      };

      document.getElementById("ergebnis").innerText = `Gesamtnote: ${gesamt.toFixed(2)} (${stufe(gesamt)})\n${zurNaechstenStufe(gesamt)}`;

      const formelText =
        `Berechnung:\n` +
        `Staatsteil = ((Straf I + Straf II + Zivil I + Zivil II + Ã–R I + Ã–R II) * 10 % + MÃ¼ndl. * 40 %)\n` +
        `           = ((${straf1} + ${straf2} + ${zivil1} + ${zivil2} + ${oeff1} + ${oeff2}) * 0.1 + ${muendlich} * 0.4) = ${staatsteil.toFixed(2)}\n\n` +
        `Gesamtnote = Staatsteil * 70 % + Schwerpunkt * 30 %\n` +
        `           = ${staatsteil.toFixed(2)} * 0.7 + ${schwerpunkt} * 0.3 = ${gesamt.toFixed(2)}`;

      document.getElementById("formel").innerText = formelText;
    }

    function resetForm() {
      document.getElementById("notenForm").reset();
      document.getElementById("ergebnis").innerText = "";
      document.getElementById("formel").innerText = "";
    }

    function toggleDarkMode() {
      const current = document.documentElement.getAttribute("data-theme");
      const next = current === "dark" ? "light" : "dark";
      document.documentElement.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
    }

    document.getElementById("notenForm").addEventListener("submit", berechneNote);

    const inputs = document.querySelectorAll("input");
    inputs.forEach((input, index) => {
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          const next = inputs[index + 1];
          if (next) next.focus();
        }
      });
    });

    // Theme bei Laden anwenden
    const gespeichertesTheme = localStorage.getItem("theme");
    if (gespeichertesTheme) {
      document.documentElement.setAttribute("data-theme", gespeichertesTheme);
    }
  </script>
</body>
</html>
